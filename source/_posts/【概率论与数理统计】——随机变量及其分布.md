---
title: 【概率论与数理统计】————随机变量及其分布
date: 2018-09-04 21:25:03
mathjax: true
tags:
- 概率论
---

> 课程名称：概率论与数理统计
> 开设学校：中科大
> 课程平台：icourse
> 第二章：随机变量及其分布，讲述离散型和连续型随机变量的概念，离散随机变量分布律，常见的离散随机变量的概率分布；随机变量的分布函数和概率密度函数

<!-- more -->



# 1. 随机变量的概念

之前我们研究的概率，是基于样本空间下的一个随机试验，研究其发生的概率，若我们要研究一连串的随机试验及其它发生的概率，往往这一连串的事件之间有联系，我们就可以引入随机变量，用一个数字或者一个区间来表示这一连串的随机事件，如 $X$ 表示抛 5 次硬币正面向上的次数，那么我们就可以用 $X=3$ 来表示 5 次有 3 次正面向上这一个随机事件；

所以，随机变量就是一个数与一个事件的对应关系，相当于是一个随机变量的一个取值对应一个随机事件，随机变量的引入就是为了更加简洁地表示一个随机事件，不需要用一大串的文字描述。但是随机变量的引入更多是为了研究一连串相关的事件，而不只是随机变量某一取值时刻下的事件，往往是研究随机变量不同取值下的不同随机事件之间的联系。
<br>
# 2. 如何研究随机变量
由于随机变量是表示一连串的事件，首先我们得确定随机变量可以取哪些值，即确定有哪些随机事件。其次我们需要研究随机变量取不同值下所表示的随机事件发生的概率。

之前说到，我们用一个数字或者一个区间来表示一个随机事件，这里面就包含了两种随机变量：离散型随机变量和连续性随机变量，前者随机变量的取值是可数的或者有限的，后者不可数。
<br>
# 3. 离散随机变量的分布
当随机变量取不同取值的时候，所表示的随机事件的概率会不同，对于离散型的随机变量，我们可以用表格的形式，列出不同取值下的概率，这就是随机变量的概率分布，即不同取值下所表示的随机事件的概率值，可以统一用以下的式子来表示。此式子叫做分布律

 $$P(X = x_k) = p_k，k = 1,2,...$$  


且满足

1. $p_k \ge 0，k = 1,2,...$
2. $\sum_1^{+\infty}p_k = 1$ 

或者用表格来表示

|  $X$  | $x_1$ | $x_2$ | $x_3$ | $...$ |
| :---: | :---: | :---: | :---: | ----- |
| $p_k$ | $p_1$ | $p_2$ | $p_3$ | ...   |


## 3.1 离散均匀分布
- 分布律：$ P(X = x_k) = \frac{1}{n}$， $k = 1,2,...,n $
- 其实就是我们之前所说的古典概型，古典概型满足两个特性，有限性和等可能性，实际上描述的就是离散均匀分布，随机变量的每个取值对应一个基本事件，每一个基本事件的概率都是一样。

## 3.2 二项分布
- 在一次试验中事件 $A$ 发生的概率为 $p$ ，把这种试验重复做 $n$ 次，若把 $X$ 记为 $n$ 次试验中事件 $A$ 发生的次数，$X$ 可以取 $0-n$，$P(X = k) = C_n^k p^k (1-p)^{n-k}$ ，称 $X$ 服从二项分布，记为 $X \sim B(n, p)$   $~$ 
{% asset_img 二项分布.png %}

- 伯努利试验：一次试验中可能的结果为 $A$ 和 $A$ 的对立事件，重复做这样的试验

- 若 $n=1$，则变为 $0-1$ 分布，或叫两点分布或伯努利分布，$X$ 只取0，1两个值，$P(X = 1) = p$, $P(X = 0) = 1 - p$，$X = 1$表示 $A$ 发生，$X = 0$ 表示 $A$ 不发生。两点分布是最简单的一种分布，任何一个只有两种可能结果的随机现象，如明天是否下雨，都属于两点分布

- 任何概率分布都应该满足 $P(X = x_k) \ge 0$,   $ \sum_1^n P(X = x_k) = 1 $，二项分布也满足，二项式定理展开就可以证明

  - $\sum_1^n P(X = x_k) = \sum_1^n C_n^{k} p^k(1-p)^{n-k} = (p + 1-p)^n = 1$

- 求解 $P(X = x_k)$取最大值的 $k$ 值
  - 令 $b_k = P(X = x_k)  = C_n^k p^k(1-p)^{n-k} = \frac{n!}{k!(n-k)!}p^k(1-p)^{n-k}$ 
  - 最大值应该满足 $\frac{b_k}{b_{k-1}} \ge 1$ 且 $\frac{b_{k}}{b_{k+1}} \ge 1$
  - 解得 $p(n+1)-1 \le k \le p(n+1)$  
  - 若 $p(n+1)$ 为整数，则最大值时k有两个值

- 例题：若100个人射飞机，射中飞机的概率为0.02，假设 $X$ 为射中飞机的人数，那么 $X \sim B(100, 0.02)$ ，100个人本来是相互独立地射飞机，但是可以看成100次重复的随机试验，所以满足二项分布


## 3.3 泊松分布
- 分布律：$P(X = x_k) = e^{-\lambda} \frac{\lambda^k}{k!}$ 
- 描述稀有事件发生的概率，交通路口发生事故的次数满足泊松分布
- 随机变量取值为：$[ 0, +\infty)$ 
- 泊松分布可以作为二项分布的一种近似
  - $X \sim B(n, p)$，$n$ 很大，$p$ 很小，$np$ 较小，$P(X = k) = C_n^k p^k (1-p)^{n-k}\approx e^{-\lambda} \frac{\lambda^k}{k!}$, $\lambda = np$ 
    - $P(X = k) = C_n^k p^k (1-p)^{n-k} = \frac{n(n-1)...(n-k+1)}{k!}p^k(1-p)^{n-k}$  
    - 因为 $p$ 很小，根据泰勒展开，$1 - p \approx e^{-p}$ ，所以 $(1-p)^{n-k} \approx e^{-p(n-k)}$ 
    - 由于泊松分布一般描述稀有事件，即 $k$ 较小，由因为 $n$ 很大，所以 $n - k \approx n$ ，$e^{-p(n-k)} \approx e^{-pn} = e^{-\lambda}$ 
    -  同样因为 $k$ 较小，$n$ 很大，$\frac{n(n-1)...(n-k+1)}{k!} p^k \approx \frac{(np)^k}{k!} = \frac{\lambda^k}{k!}$   
  - 二项分布不好算，可以用泊松分布近似计算，从上面的推导可以看出 $k$ 不能很大
  - $n$ 很大，$np$ 很小，准确点说 $n >30$，$np < 5$ 即可
  {% asset_img 泊松分布.png %}



二项分布当n等于1时，可以转成两点分布；当n很大，p很小的时候，可以转成泊松分布。

<br>

# 4. 分布函数和密度函数

## 4.1 分布函数

上面提到的都是离散型随机变量的概率分布 $P(X =x_k) = p_k,  k = 0,1,2,...$ ，离散型随机变量的取值是有限的或者是可数的，离散型变量的一个取值对应一个随机事件，而对于连续型变量，通常用一段区间来表示一个随机事件，如 $P(a < X \le b)$，这个概率又可以表示为 $P(X \le b) - P(X \le a)$。

- 定义：$P(X \le x) = F(x)$，$-\infty < x < +\infty$。随机变量 $X$ 的分布函数

- 分布函数直观来说就是表示随机变量取值小于某个值的概率，它具有以下几个性质
  - 分布函数是非递减的，且 $lim_{x\to -\infty} F(x) =0$ ，$lim_{x\to +\infty} F(x) =1$，从分布函数的定义就可以看出。
  - 离散型随机变量的分布函数不连续，因为离散变量的取值是有限的，因此分布函数会呈现出阶梯状，且是右连续的
    - $F(x) = P(X \le x)=\sum_{x_{k} \le x} P(X = x_k) $ 
  - 连续型随机变量的分布函数是连续且递增的，有了分布函数，某个区间的概率值就很容易计算，$P(a < X \le b) = F(b) - F(a)$，
{% asset_img 分布函数.png %}



- 注意区分以下分布律和分布函数，分布律是描述离散随机变量遵循的分布，简单来说就是取不同值的概率；而分布函数是随机变量小于某个值的概率



## 4.2 密度函数

随机变量的分布函数 $F(x)$ 是描述随机变量取值小于某个值下的概率的函数，而随机变量的密度函数 $f(x)$ 满足以下几个条件，注意并不是所有的随机变量或者分布函数都有对应的密度函数，但是所有的随机变量都有分布函数

1. $f(x)$ 是非负的
2. $\int_{-\infty}^{+\infty} f(x)dx=1$ 
3.  $F(x) = \int_{-\infty}^{x}f(t)dt$  

从上面的定义可以看出，密度函数 $f(x)$ 是分布函数 $F(x)$ 的微分，而 $F(x)$ 是 $f(x)$ 的积分，所以计算以下概率可以转变成求密度函数的积分，注意无论是分布函数还是密度函数，还是分布律，他们都是服务于算概率的

$$P(a < X \le b) = F(b) - F(a) = \int_a^b f(x)dx$$

上面定义的第二点，也很容易理解，$\int_{-\infty}^{+\infty} f(x)dx=F(+\infty)-F(-\infty)=1-0=1$  

对于连续型随机变量 $P(X = a) = 0$，因为 $P(X = a) = lim_{h\to 0} \int_{a-h}^{a}f(x)dx=0$ 

分布函数连续不一定是连续型随机变量的分布函数，连续不一定可微，只有密度函数存在，才能说是连续随机变量

## 4.3 总结一下

对于离散型的随机变量，只可以取有限个或者可数个值，我们可以用分布律去描述它，$P(X = x_k) = p_k$   

对于连续型的随机变量，我们用一个区间去表示一个随机事件，但由于区间涉及两个边界值，我们引入分布函数 $F(x)$ 描述随机变量取值小于某个值的概率，进而引入密度函数 $f(x)$，然后概率值就可以转化为求密度函数的积分值

但是对于离散型随机变量，我们也可以研究它的分布函数，但是它没有概率密度函数，因为它的分布函数不可微




<br>
# 5. 连续随机变量的分布

对于离散随机变量，我们可以用分布律来描述，对于连续型随机变量，我们可以用分布函数或密度函数来描述，分布律、分布函数、密度函数都是为了算概率而存在的

## 5.1 均匀分布

- 若一个随机变量的密度函数为以下的形式，则该随机变量服从均匀分布，$X \sim U(a,b)$ 

  $$f(x)= \left\{\begin{array}{cc} 
  \frac{1}{b-a}, & a \le x \le b\\ 
  0, & other\ values 
  \end{array}\right.$$  

- 均匀分布可以用示性函数 $I$ 来表示，$f(x) = \frac{1}{b-a}I_{a\le x\le b}(x)$ 

## 5.2 指数分布

- 指数分布的随机变量，密度函数满足 $f(x) =\lambda e^{-\lambda x} I_{x \ge 0}(x)$，$\lambda > 0$，$X \sim exp(\lambda)$  

  $$f(x)= \left\{\begin{array}{cc} 
  \lambda e^{-\lambda x}, & x \ge 0\\ 
  0, & x < 0 
  \end{array}\right.$$ 

- $\lambda$ 越大，密度函数下降得越快
{% asset_img 指数分布.png %}

- 指数分布最大的特点是无后效性，通常用来描述元件的寿命，即寿命是无老化的，假如我知道一个元件已经用了 $s$ 个小时，想知道原件能用 $s + t$ 个小时的概率，它就等于原件用 $t$ 个小时的概率
  - $P(X > s+t \mid X>s) = P(X >t)$  
  - 证明：
    - 令事件 $A$ 为 $X > s+t$，事件 $B$ 为 $X > s$，则 $P(A \mid B) = \frac{P(AB)}{P(B)}$  
    - 可以看出 $B \subset A$，所以 $P(AB) = P(A)$ 
    - $P(A) = \int_{s+t}^{+\infty} \lambda e^{-\lambda x}dx$ 
    - 令 $\lambda x=u$，则 $P(A) = \int_{\lambda(s+t)}^{+\infty} e^{-u}du = -e^{-u} \mid_{\lambda(s+t)}^{+\infty} = e^{-\lambda(s+t)}$  
    - 同理，$P(B)=e^{-\lambda s}$  
    - 因此，$P(A \mid B) = \frac{P(A)}{P(B)} = e^{-\lambda t} = P(X > t)$  



## 5.3 正态分布

- 密度函数满足 $f(x) = \frac{1}{\sqrt{2\pi} \sigma} exp(-\frac{(x-\mu)^2}{2\sigma^2})$，$-\infty < x < +\infty$，记为 $X \sim N(\mu, \sigma^2)$    
- 密度函数的曲线有以下性质
  - 对称函数，对称轴为 $x = \mu$，对称轴左边单调递增，对称轴右边单调递减，极值落在 $x = \mu$ 上，为$\frac{1}{\sqrt{2\pi} \sigma}$
  - $\sigma$ 的大小决定了密度函数的陡峭程度
- 当 $\mu = 0$，$\sigma = 1$ 的时候，称为标准正态分布，密度函数记为 $\phi(x)$，分布函数记为 $\Phi(x)$ 
  - 分布函数 $\Phi(x)$ 是密度函数 $\phi(x)$ 的积分，$\Phi(x) = \int_{-\infty}^x \phi(t)dt$ 
  - $\Phi(x) = 1 - \Phi(-x)$，可以从密度函数 $\phi(x)$ 算面积很容易证出。
- 一般的正态分布 $X \sim N(\mu, \sigma^2)$ 都可以转成标准正态分布 $X \sim N(0, 1)$，其分布函数 $F(x) = \Phi(\frac{x-\mu}{\sigma})$ ，然后通过查标准正态分布表格来算出概率。


<br>
# 6. 多维随机变量

多维随机变量也称随机向量，跟一维随机变量一样，多维随机变量就是多个随机事件的并集，或者说是多个事件的联合概率，像一维随机变量，我们同样关注多维随机向量的分布。

## 6.1 二维离散型随机向量的分布

$P(X=x_i, Y=y_j)=p_{i,j}$ 

 同样应该满足密度分布的基本条件

1. $p_{i,j}>0$
2. $\sum\sum p_{ij}=1$ 

## 6.2 二维连续型随机向量的分布

类似一维随机变量，我们用分布函数来描述它的概率分布，$F(x,y)$ 称为随机向量 $(X,Y)$ 的联合分布函数。

$F(x, y)=P(X \le x, Y \le y)$ 

将二维随机变量 $(X,Y)​$ 看成是平面上随机点的坐标，那么，分布函数 $F(x,y)​$ 在点 $(x,y)​$ 处的函数值就是下图无穷矩形域内的面积占整个平面的概率。
{% asset_img 二维随机变量.png %}

$F(x,y)$ 有如下性质：

1. 给定 $y$，$F(x,y)$ 是 $x$ 的非减函数；给定 $x$, $F(x,y)$ 是 $y$ 的非减函数
2. $\lim_{x \rightarrow -\infty} F(x,y)=0$，$\lim_{y \rightarrow -\infty} F(x,y)=0$，$\lim_{x \rightarrow +\infty, y \rightarrow +\infty} F(x,y)=1$ 
3. $P(a<X \le b, c < Y \le d) = F(b,d) - F(a,d) - F(b,c) + F(a,c)$     
4. $P(X \le x_i) = P(X \le x_i, Y \le +\infty) = F(x_i, +\infty)$ 
5. $F(x,y)$ 分别是关于 $x$ 和 $y$ 右连续

同样从分布函数引出概率密度函数，若对分布函数 $F(x,y)$，存在 $f(x,y) \ge 0$，使得对任一 $(x,y) \in R^2$，有 $F(x,y)=\int_{-\infty}^{x} \int_{-\infty}^{y} f(u,v)dudv$，则称 $F(x,y)$ 为连续型联合分布函数，$f(x,y)$ 为联合密度函数。 $f(x,y)$ 同样具有以下性质：

1. $f(x,y) \ge 0$  
2. $\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f(x,y)dxdy=1$ 
3. $\frac{\partial F(x,y)}{\partial x \partial y} = f(x,y)$ 

几何上，$z=f(x,y)$ 表示空间的一个曲面，$\int_{-\infty}^{+\infty} \int_{-\infty}^{+\infty} f(x,y)dxdy=1$ 表示介于 $f(x,y)$ 与 $xOy$  平面之间的空间区域的面积。
{% asset_img 二维正态.png %}


<br>
# 7. 边缘分布(marginal distribution)

- 定义：已知 $(X,Y)$ 的联合分布函数为 $F(x,y)$，则 $X$ 的分布 $F_1(x)$ 和 $Y$ 的分布 $F_2(y)$ 称为 $F(x,y)$ 的边缘分布
  - $F_1(x)=P(X \le x)=P(X \le x, Y \le +\infty)=F(x, +\infty)$ 
  - $F_2(y)=P(Y \le y)=P(Y \le y, X \le +\infty) = F(+\infty, y)$ 

- 二维离散型随机变量的边缘分布
  - 二维离散随机变量的分布一般以联表的形式表示
  - 固定某个 $x_i$，$P(X=x_i) = \sum_{j=1}^{m}p_{ij}$，联表每一行的求和就是随机变量 $X$ 的边缘分布，可记为 $p_{i\bullet}$ 
  - 固定某个 $y_i$ ，$P(Y=y_j) = \sum_{i=1}^{n}p_{ij}$ ，联表每一列的求和就是随机变量 $Y$ 的边缘分布，可记为 $p_{\bullet j}$ 

- 二维连续型随机变量的边缘分布
  - 二维连续随机变量的分布一般以概率密度函数的形式表示
  - 从联合密度函数，求 $X$ 的密度函数，就需要将随机变量 $Y$ 从积分中去掉，$f_X(u) = \int_{-\infty}^{+\infty}f(u,v)dv$ 
    - $F_X(x) = F(x, +\infty)=\int_{-\infty}^x[\int_{-\infty}^{+\infty}f(x,y)dy]dx=\int_{-\infty}^{x}f_X(x)dx$ 
  - 同理，求 $Y$ 的密度函数，，$f_Y(v) = \int_{-\infty}^{+\infty}f(u,v)du$    

- 二维正态分布的边缘分布就是一维正态分布

- 注意：联合分布可以推出边缘分布，但是边缘分布不能推出联合分布，例子：一维正态分布推不出二维正态分布，二维正态分布还有一个参数 $\rho$

<br>
# 8. 条件分布

假设有两个随机变量 $X,Y$，在给定 $Y$ 取某个或某些值的条件下，$X$ 的概率分布就叫做 $Y = y_j$ 条件下 $X$ 的条件分布律。

## 8.1 离散型随机变量的条件分布

- 定义：设 $(X,Y)$ 为二维离散型随机变量，若对固定的 $j$ ，称 $P(X=x_i \mid Y=y_j) = \frac{p_{ij}}{p_{\bullet j}}$ 为 $Y = y_j$ 条件下的 $X$ 的条件分布律；同理，对固定的 $i$ ，称 $P(Y=y_j \mid X=x_i) = \frac{p_{ij}}{p_{i\bullet}}$  为 $X = x_i$ 条件下的 $Y$ 的条件分布律；
- 条件分布是一种概率分布，它具有概率分布的一切性质，正如条件概率是一种概率，具有概率的一切性质一样。
  - $P(X=x_i \mid Y=y_j) \ge 0$
  - $\sum_{i=1}^{\infty} P(X=x_i \mid Y=y_j) =1$ 
- 离散型随机变量的条件分布，就是在联合分布的联表的某一行或者某一列的分布。
- 由条件分布和边缘分布，可以根据乘法公式，求得联合分布
  - $P(X=x_i, Y=y_j) = P(X=x_i)P(Y=y_j \mid X= x_i)$ 

## 8.2 连续型随机变量的条件分布

- 定义：设 $X$ 和 $Y$ 的联合概率密度为 $f(x,y)$，$(X,Y)$ 关于 $Y$ 的边缘概率密度为 $f_Y(y)$，若对于固定的 $y$，$f_Y(y) >0$，则称 $\frac{f(x,y)}{f_Y(y)}$ 为在 $Y = y$ 的条件下 $X$ 的条件概率密度，记为 $f_{X \mid Y}(x \mid y) = \frac{f(x,y)}{f_Y(y)}$，同理，$f_{Y \mid X}(y \mid x) = \frac{f(x,y)}{f_X(x)}$ 

- 由条件密度和边缘密度，可以得到联合密度
  - $f(x,y)=f_X(x)f_{Y \mid X}(y \mid x)$ 
- 例题：从 [0,1] 中随机取一个数 $X$， 则 $X \sim U(0,1)$，当 $X=x$ 时，再从 $(0,x)$ 中随机取一个数 $Y$，求 $Y$ 的分布。
  - 题目给定 $X$ 的分布，以及在 $X = x$ 下 $Y$ 的条件分布，自然可以算出 $(X,Y)$ 的联合分布，再从联合分布就可以算出 $Y$ 的边缘分布
  - $f_X(x)=I_{(0,1)}(x)$，$f_{Y \mid X}(y \mid x) = \frac{1}{x}I_{(0,x)}(y)$ 
  - 联合分布：$f(x,y) = I_{(0,1)}(x) \frac{1}{x}I_{(0,x)}(y)$ 
  - 边缘分布：$f_Y(y)=\int f(x.y)dx$，算这种积分最重要的就是搞清楚，谁变谁不变，以及积分的上下限是多少，显然被积的是 $x$，所以 $x$ 是变量，$y$ 是常数，所以我们固定某一个 $y$，可以得出 $x$ 的范围是 $[y,1]$，因此 $f_Y(y)=-ln(y)$ ，最后限定 $y$ 的范围是 $(0,1)$ 



**有了联合分布，边缘分布和条件分布都能求**
<br>
# 9. 随机变量的独立性

- 回忆两个随机事件独立的定义是：$P(AB)= P(A)P(B)$
- 随机变量之间的独立好比，两个或多个随机变量的任意取值所代表的随机事件都相互独立
  - 离散型随机变量：$P(X = x_i, Y = Y_j) = P(X = x_i)P(Y = y_j)$ 
  - 连续型随机变量独立即联合分布等于边缘分布的乘积，$F(x,y) = F_X(x)F_Y(y)$；或联合密度等于边缘密度的乘积，$f(x,y)=f_X(x)f_Y(y)$ 
-  两个随机变量 $(X,Y)$ 相互独立就是指 $X$ 有关的任何事件发生与否都与 $Y$ 有关的任意时间发生与否无关。
- 随机变量的独立是随机事件独立的延申，从两个事件的独立，延申至一系列事件的独立。
- 如果多个随机变量相互独立，且分布一致，称为独立同分布，简称 independent identical distribution(iid).


<br>
# 10. 随机变量的函数的概率分布

- 随机变量函数：已知随机变量 $X$ 的分布，另一个随机变量 $Y$ 满足 $Y = g(X)$，这就是随机变量的函数，我们可以从自变量(随机变量 $X$ )的分布求出随机变量 $Y$ 的分布
  - 连续型：$F(y) = P(Y \le y) = \int_{g(x)\le y} f(x)dx$ 
  - 离散型：$P(Y = y_j) = \sum_{g(x_i)=y_j}P(X = x_i)$ 
- 推广至随机向量的函数：已知随机向量 $(X,Y)$ 的分布，另一个随机变量 $Z = g(X, Y)$，求 $Z$ 的分布
  - 连续型： $F(Z) = P(Z \le z)= \int\int_{g(x,y) \le z}f(x,y)dxdy$ 
  - 离散型：$P(Z = z_q) = \sum_{g(x_i,y_j) = z_q}P(X = x_i, Y = y_j)$，若 $X$ 和 $Y$ 独立，那么后面的概率可以拆成两个单独概率想乘。
- 推广至随机向量的多个函数： 已知随机向量 $(X,Y)$ 的分布，另一个随机变量 $Z_1 = g_1(X, Y)$，另一个随机变量 $Z_2 = g_2(X, Y)$，求 $(Z_1, Z_2)$ 的联合分布
  - $F(Z_1, Z_2) = P(Z_1 \le z_1, Z_2 \le z_2) = \int\int_{Z_1 = g_1(X, Y) \le z_1, Z_2 = g_2(X, Y) \le z_2} f(x,y)dxdy$  
  - 设 $u = g_1(x,y)$，$v = g_2(x,y)$，若反函数存在，即 $x = \phi(u, v)$，$y = \psi(u,v)$， 
  - $\int\int_{Z_1 = g_1(X, Y) \le z_1, Z_2 = g_2(X, Y) \le z_2} f(x,y)dxdy = \int\int_{u \le z_1, v \le z_2} f(\phi(u,v), \psi(u,v)) \frac{dxdy}{dudv}dudv$ 
    - $\frac{dxdy}{dudv} = |J|$，为 $(x,y)$ 关于 $(u,v)$ 的 Jacobi行列式
    - $J = \left|\begin{array}{cccc}  \frac{\partial x}{\partial u} &    \frac{\partial x}{\partial v} \\
     \frac{\partial y}{\partial u} &    \frac{\partial y}{\partial v}\\ 
      \end{array}\right|  $     
  - 所以 $(Z_1,Z_2)$ 的分布函数等于 $F(Z_1, Z_2) = \int_{-\infty}^{z_1}\int_{-\infty}^{v_1} f(\phi(u,v), \psi(u,v)) |J|dudv$，
  - 同理，$(Z_1,Z_2)$ 的密度函数为 $ f(\phi(u,v), \psi(u,v)) |J|$ 
- 例题：在直角坐标平面随机选取一点，分别以随机变量 $X$ 和 $Y$ 表示其横纵坐标，可以认为 $X$ 和 $Y$ 相互独立，且都服从正态分布 $N(0,1)$，求极坐标 $(R, t)$ 的分布 
  - 题意是已知 $X$ 和 $Y$ 的分布，求 $(R,t)$ 的联合分布
  - 反函数很容易得：$x = Rcost$，$y = Rsint$，$R \in [0, +\infty]$，$t \in [0, 2 \pi)$ 
  - $J = \left|\begin{array}{cccc} \frac{\partial x}{\partial R} &    \frac{\partial x}{\partial t} \\
   \frac{\partial y}{\partial R} &    \frac{\partial y}{\partial t}\\ 
    \end{array}\right| = \left|\begin{array}{cccc} cost &    -Rsint \\
   sint &   Rcost\\ 
    \end{array}\right| = R$
     
  - $(X,Y)$ 的联合密度为其边缘密度的乘积($X$ 和 $Y$ 相互独立)，$f(x,y) = \frac{1}{2\pi}exp(-\frac{x^2+y^2}{2})$ 
  - $f(R,t) =  f(Rcost, Rsint) |J| = \frac{1}{2\pi}Rexp(-\frac{R^2}{2})$，$R > 0$，$t \in [0, 2 \pi)$ 
  - $f(R,t) = f_1(R)f_2(t)$，其中 $f_1(R) = Rexp(-\frac{R^2}{2})I_{R>0}(R)$，$f_2(t) = \frac{1}{2\pi}I_{[0,2\pi)}(t)$，由于f(R,t) 可以写成两个密度函数的乘积，所以 $R$ 和 $t$ 相互独立，且 $t$ 服从 $[0,2\pi)$ 的均匀分布 

- 注意：两个服从正态分布的随机变量的和也服从正态分布，$X \sim N(\mu_1, \sigma_1^2)$，$Y \sim N(\mu_2, \sigma_2^2)$，且 $X$ 和 $Y$ 相互独立，则 $X + Y  \sim N(\mu_1 +\mu_2, \sigma_1^2 + \sigma_2^2)$ 

- 设 $X$ 和 $Y$ 是两个相互独立的随机变量，求 $M = max(X,Y)$ 的分布

  - $F_M(z) = P(max(X,Y) \le z) = P(X \le z, Y \le z) = P(X \le z)P(Y \le z) = F_X(z)F_Y(z)$  
  - 密度函数：$f_M(z) = \frac{\partial F_M(z)}{\partial z} = f_X(z)F_Y(z) + F_X(z)f_Y(z)$ 
  - 推广至n个随机变量的最大值也是同样的道理，最大值小于 $z$，即每个随机变量都小于 $z$

-  设 $X$ 和 $Y$ 是两个相互独立的随机变量，求 $N = min(X,Y)$ 的分布

  - $N$ 等于 $X$ 和 $Y$ 的最小值，$N \le z$，即 $X$ 和 $Y$ 的任意一个小于 $z$，求它的对立事件，即 $X$ 和 $Y$ 都大于 $z$

  - $F_N(z) = P(N \le z) = 1-P(N > z) = 1- P(X > z, Y > z) = 1 - P(X > z)P(Y > z) $ 

    $= 1 - (1-F_X(z))(1-F_Y(z))$  

  - 密度函数：$f_N(z) = \frac{\partial F_N(z)}{\partial z} = -f_X(z)(1-F_Y(z)) + (1-F_X(z))f_Y(z)$  

 关键就是改变积分的区域，通过随机变量函数，约定积分区域


<br>
# 11. 统计三大分布

$\Gamma(x)=\int_0^\infty e^{-t}t^{x-1}dt$，$x > 0$

性质：

1. $\Gamma(x+1) = x\Gamma(x)$，$\Gamma(1)=1$，$\Gamma(n+1) = n!$ 
2. $\Gamma(\frac{1}{2}) = \sqrt{\pi}$ 

## 11.1 卡方分布(chi-squared distribution)

- 定义：设 $X_1, X_2, ..., X_n$ 独立同分布，均服从标准正态分布，$\chi^2 = \sum_1^nX_i^2$，则称 $\chi^2$ 是自由度为 $n$ 的卡方分布，记为 $\chi_n^2$，自由度是指能够自由变换的自变量的个数，如果受到一个约束，自由度就要减一，依次类推。

- 卡方分布的密度函数为

  - $f_n(x) = \frac{x^{\frac{x-2}{2}}e^{-\frac{x}{2}}}{2^{\frac{n}{2}}\Gamma(\frac{n}{2})}$ 

  - 当 $n=1$，$f_1(x) = \frac{x^{-\frac{1}{2}}e^{-\frac{1}{2}}}{2^{\frac{1}{2}} \sqrt{\pi}}$，为单调递减函数；当 $n=2$，$f_2(x) = e^{-x}$，同为单调递减，当 $n \ge 3$，曲线有单峰，从 $0$ 开始单调上升，再单调下降趋向于0；由于是密度函数，其积分值为1。
{% asset_img 卡方分布.png %}

  - 若 $X \sim \chi_n^2$，记 $p(X > c) = \alpha$，则 $c = \chi_n^2(\alpha)$ 称为卡方分布的上侧分位数，给定 $\alpha$，可以通过查卡方分布表格，求出 $c$。
{% asset_img 卡方分布alpha.png %}

## 11.2 t 分布

- 又称 student‘s distribution

- 定义：设 $X \sim N(0,1)$，$Y \sim \chi_n^2$，且 $X$ 和 $Y$ 相互独立，令 $T = \frac{X}{\sqrt{\frac{Y}{n}}}$，则称 $T$ 的分布为自由度为 $n$ 的t分布，记为 $T \sim t_n$。

- 概率密度函数为

  - $t_n(x) = \frac{\Gamma(\frac{n+1}{x})}{\sqrt{n\pi}\Gamma(\frac{n}{2})}(1+\frac{x^2}{n})^{-\frac{n+1}{2}}$ 
{% asset_img t分布.png 500 250 %}

  - 与标准正态分布的关系

    - t分布的密度函数与标准正态分布的密度很相似，都是关于y轴对称，偶函数
    - t分布密度函数的峰值要低于标准正态的峰值，但尾部要比正态要高，这很正常，因为密度函数积分都要等于1，中间高度低了，两边的高度就要上升
    - 当 $n$ 趋于无穷的时候，$t_n$ 会趋于标准正态。

  - 若 $T \sim t_n$，$P(|T| > c) = \alpha$，则 $c = t_n(\alpha / 2)$ 称为t分布的双侧 $\alpha$ 分位数
{% asset_img t分布alpha.png %}

## 11.3 F 分布

- 定义：$X \sim \chi_n^2$， $Y \sim \chi_m^2$，$X$ 和 $Y$ 相互独立，令 $Z = \frac{X/n}{Y/m}$，则称 $Z$ 为自由度是 $n$ 和 $m$ 的 $F$ 分布，记为 $F \sim F_{n,m}$ 

- $t$ 分布的平方为一个自由度为1和n的F分布，$t_n^2 = \frac{X^2}{Y/n}$，$X$ 为标准正态，$X^2$ 为自由度为1的卡方分布

- 同样有上测 $\alpha$ 分位数的概念
{% asset_img F分布.png %}

- 性质：$F_{m,n}(1-\alpha) = \frac{1}{F_{n,m}(\alpha)}$ 
<br>
# 12. 总结
这一章将随机事件过渡为随机变量，进而描述一系列随机事件发生的概率，也就是所谓的随机变量的分布，很多第一章提到的概念，如条件概率，在这一章都会以分布的形式出现，都是描述一系列的概率值，牢记，无论是分布函数还是密度函数，还是积分，它们都是为算概率服务的，最终目的都是算概率。

<br>